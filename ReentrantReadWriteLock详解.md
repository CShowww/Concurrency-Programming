# 一、概述
相对于ReentrantLock，他是一种更细粒度的锁。读操作允许多个线程共同访问统一资源，而写操作则只允许一个线程获取锁，这样是为了避免脏读的现象。

# 二、特性
- 支持公平性和非公平性的锁获取方式。
- 支持重写入
- 写锁能够降级成为读锁。

# 三、实现分析
1. 读写状态的设计  
读写锁的自定义同步器需要在同步状态上维护多个读线程和一个写线程的状态，为了实现此目的，使用按位切割使用这个变量。一个32位的int变量，前16位表示读，后16位表示写。
2. 写锁的获取与释放  
写锁是一个支持重进入的排他锁。如果当前线程已经获得写锁，则增加写状态。如果此时读锁已经被获取或者该线程不是获取写锁的线程，则当前线程进入等待状态。存在读锁从而不能获取写锁的目的是，读写锁要确保写锁的操作对读锁可见。  
写锁的释放和ReentrantLock的释放过程基本类似  
3. 读锁的获取与释放  
读锁是一个支持重入的共享锁。他能够被多个线程获取。如果当前线程已经获得了读锁，则增加读状态。如果当前线程在获取读锁时，写锁已经被其他线程获取，则进入等待状态。

